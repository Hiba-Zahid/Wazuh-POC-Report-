Wazuh POC Report â€” Threat Detection & Lab Setup

This repository contains a Proof-of-Concept (POC) demonstrating the setup, configuration, and testing of a Wazuh security monitoring environment. The project includes deploying Wazuh components, adding monitored endpoints, and performing a controlled SSH brute-force attack to validate Wazuhâ€™s detection and alerting capabilities.

ğŸ“Œ Objective

To set up a complete Wazuh lab and simulate a real-world security event (SSH brute-force attack) in order to observe how Wazuh detects, logs, and alerts on suspicious activity.

ğŸ›  Environment Setup

Platform: VirtualBox

Wazuh Components: Manager + Dashboard (OVA)

Endpoint VMs:

Target VM (Wazuh Agent installed)

Attacker VM (Kali Linux with sshpass)

Pre-test verification included checking SSH service, Wazuh agent status, and agent connectivity via the Wazuh Dashboard.

ğŸ“¥ Agent Deployment

Import Wazuh OVA and launch central components.

Deploy endpoint VMs and install Wazuh agents.

Register agents with the manager and verify they are connected and reporting.

ğŸ” Use Case: SSH Brute-Force Simulation

A safe and controlled brute-force attack was performed using:

A test user (testuser)

15 failed SSH login attempts using sshpass

Monitoring real-time logs on the target VM

Safety steps included VM isolation, snapshot creation, and removing the test user afterward.

ğŸ“Š Detection & Analysis

Alerts generated by Wazuh were observed through:

Explore â†’ Discover (wazuh-alerts-* index)

Threat Hunting

Detected events showed:

Failed SSH authentication attempts

Source agent

Timestamps

Rule metadata

This validated the working detection and alerting pipeline.

ğŸ§¹ Cleanup

Removed testuser

Restored or maintained VM snapshots

âœ… Conclusion

The Wazuh POC successfully demonstrated:

Proper deployment of Wazuh components

Effective SSH brute-force detection

Accurate alert logging through the dashboard
